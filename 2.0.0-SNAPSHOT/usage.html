<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2017-07-13 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170713" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Oracle Coherence Spring Integration &#x2013; Oracle Coherence Spring Integration Usage</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<link rel="shortcut icon" href="images/coherence-spring.ico"/>
                      
        
<script src="js/site.js" type="text/javascript"></script>
          
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/coherence-community/coherence-spring-integration/">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Coherence Spring Site</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2017-07-13
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 2.0.0-SNAPSHOT
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Spring Integration</li>
                              
      <li>
  
                          <a href="index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                
      <li>
  
                          <a href="history.html" title="Change History">
          <i class="none"></i>
        Change History</a>
            </li>
                
      <li>
  
                          <a href="support.html" title="Getting Help">
          <i class="none"></i>
        Getting Help</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Usage</a>
          </li>
                              <li class="nav-header">Recommended Reading</li>
                              
      <li>
  
                          <a href="http://tinyurl.com/ooantax" class="externalLink" title="Coherence Namespaces">
          <i class="none"></i>
        Coherence Namespaces</a>
            </li>
                              <li class="nav-header">Development</li>
                              
      <li>
  
                          <a href="license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                
      <li>
  
                          <a href="source-code.html" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                
      <li>
  
                          <a href="building.html" title="Build Instructions">
          <i class="none"></i>
        Build Instructions</a>
            </li>
                
      <li>
  
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                
      <li>
  
                          <a href="contributions.html" title="Contributions">
          <i class="none"></i>
        Contributions</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2><a name="Oracle_Coherence_Spring_Integration_Usage"></a>Oracle Coherence Spring Integration Usage</h2>
<p>The Oracle Coherence Cache Configuration file <tt>coherence-cache-config.xml</tt> allows use of the <tt>&lt;class-scheme&gt;</tt> and <tt>&lt;instance&gt;</tt> xml elements as mechanisms to specify custom implementations of Coherence interfaces, such as <tt>CacheStore</tt> and <tt>MapListener</tt>. Traditionally Oracle Coherence uses these elements to guide the instantiation of developer provided interface implementations in two ways; It can</p>

<ul>
  
<li>Create a new instance of a specified class</li>
  
<li>Invoke a user-provided factory method to return a specific instance</li>
</ul>
<p>For some applications it may be useful for Coherence to retrieve objects configured in a <tt>&lt;class-scheme&gt;</tt> element or <tt>&lt;instance&gt;</tt> element from alternative sources, say for example a Spring <tt>BeanFactory</tt> instance, instead of creating its own instance. This is especially true for cache servers configured with <tt>CacheStore</tt> objects running in a standalone JVM, because these <tt>CacheStore</tt> objects typically must be configured with data sources, connection pools, and so on. Spring provides the ability to configure such data sources for plain Java objects, without requiring Java EE.</p>

<div class="section">
<div class="section">
<h4><a name="The_Spring_Namespace_Handler"></a>The Spring Namespace Handler</h4>
<p>The Coherence Spring Namespace Handler <tt>com.oracle.coherence.spring.SpringNamespaceHandler</tt> is a custom extension to Coherence that allows you to configure Coherence to reference existing Spring beans in a cache configuration file instead of creating new instances at runtime.</p>
<p>The references to Spring Beans are made declaratively in XML files using the new Spring namespace for Coherence. The schema definitions for the Coherence Spring namespace elements are described in the <tt>coherence-spring-config.xsd</tt> file. You can find this file in the <tt>coherence-spring.jar</tt> file.</p>
<p><b>Coherence Spring Configuration Elements</b></p>

<table border="0" class="table table-striped" cellspacing="20">
  
<tr class="a">
    
<th width="30%">Element</th>
    
<th width="25%">Used In</th>
    
<th>Description</th>
  </tr>
  
<tr class="b">
    
<td valign="top"><tt>application-context-uri</tt></td>
    
<td valign="top"><tt>bean-factory</tt></td>
    
<td>(Optional) Defines a location for a Spring application context XML file.
        If URL notation is used, the file will be loaded as a URL
        (that is, file://, http://); otherwise the file will be
        loaded from the classpath.  When not provide Coherence will look up
        an ApplicationContext (and BeanFactory) using the SpringBasedCoherenceSession
        that loaded the Coherence Cache Configuration File.</td>
  </tr>
  
<tr class="a">
    
<td valign="top"><tt>bean</tt></td>
    
<td valign="top"><tt>class-scheme</tt> <tt>instance</tt></td>
    
<td>Defines a Spring bean that will be provided to Coherence.
        Use the property attribute to inject a property into a
        Spring bean.</td>
  </tr>
  
<tr class="b">
    
<td valign="top"><tt>bean-factory</tt></td>
    
<td valign="top">Must appear as the first subelement under
       <tt>cache-config</tt></td>
    
<td>Defines a Spring bean factory that will be used to
        provide named beans to Coherence.</td>
  </tr>
  
<tr class="a">
    
<td valign="top"><tt>bean-name</tt></td>
    
<td valign="top"><tt>bean</tt></td>
    
<td>Identifies the name of a bean to be retrieved from a
        Spring bean factory.</td>
  </tr>
  
<tr class="b">
    
<td valign="top"><tt>factory-name</tt></td>
    
<td valign="top"><tt>bean</tt> <tt>bean-factory</tt></td>
    
<td>Identifies a Spring bean factory. This name is used to
        refer to a factory when defining a bean definition.</td>
  </tr>
</table>
</div>
<div class="section">
<h4><a name="Declaring_the_Spring_Namespace_Handler"></a>Declaring the Spring Namespace Handler</h4>
<p>To use the Coherence Spring namespace handler, you must declare it in a cache configuration file and then specify a factory for the Spring beans.</p>
<p>Use the following Coherence Spring namespace handler declaration in the <tt>&lt;cache-config&gt;</tt> element of a cache configuration file:</p>

<div class="source">
<div class="source">
<pre>xmlns:spring=&quot;class://com.oracle.coherence.spring.SpringNamespaceHandler&quot;
</pre></div></div>
<p>To ensure proper configuration within the cache configuration file, the XSD file <tt>coherence-spring-config.xsd</tt> that corresponds with this namespace handler can also be referenced, as illustrated below:</p>

<div class="source">
<div class="source">
<pre>&lt;cache-config
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns=&quot;http://xmlns.oracle.com/coherence/coherence-cache-config&quot;
    xmlns:spring=&quot;class://com.oracle.coherence.spring.SpringNamespaceHandler&quot;
    xsi:schemaLocation=&quot;http://xmlns.oracle.com/coherence/coherence-cache-config coherence-cache-config.xsd
                        class://com.oracle.coherence.spring.SpringNamespaceHandler coherence-spring-config.xsd&quot;&gt;
</pre></div></div>
<p>If your cache configuration must specify an externally provided user class by using a  <tt>&lt;class-scheme&gt;</tt> or <tt>&lt;instance&gt;</tt> element, then this namespace handler can provide a  Spring bean from a <tt>BeanFactory</tt>. To specify a Spring bean, use the <tt>bean</tt> and  <tt>bean-name</tt> elements under the <tt>&lt;class-scheme&gt;</tt> or <tt>&lt;instance&gt;</tt> element:</p>

<div class="source">
<div class="source">
<pre>&lt;class-scheme&gt;
    &lt;spring:bean&gt;
        &lt;spring:bean-name&gt;listener&lt;/spring:bean-name&gt;
    &lt;/spring:bean&gt;
&lt;/class-scheme&gt;
</pre></div></div>
<p>You can also use the property attribute to inject properties (including cache configuration macros) into a bean, as illustrated below:</p>

<div class="source">
<div class="source">
<pre>&lt;spring:bean&gt;
    &lt;spring:bean-name&gt;listener&lt;/spring:bean-name&gt;
    &lt;spring:property name=&quot;backingMapManagerContext&quot;&gt;{manager-context}&lt;/spring:property&gt;
&lt;/spring:bean&gt;
</pre></div></div>
</div>
<div class="section">
<h4><a name="Specifying_a_Factory_for_Spring_Beans"></a>Specifying a Factory for Spring Beans</h4>
<p>You can specify the bean factory that provides the Spring beans in one of the following ways:</p>

<ul>
  
<li>Specify an Application Context in the cache configuration file</li>
  
<li>Specify a Bean Factory as a resource</li>
</ul>

<blockquote>
<p>If an Application Context or Bean Factory is not provided using these approaches Coherence will attempt to use the SpringBasedCoherenceSession that loaded the Cache Configuration File containing the &lt;spring:bean&gt; definitions.</p>
</blockquote>
<p>Use the <tt>application-context-uri</tt> element to specify the location of the Spring application context XML file. Like the cache configuration file, the application context file will be loaded either by using the file system or the classpath. The <tt>application-context-uri</tt> element also supports URLs as values. In the following example, <tt>application-context.xml</tt> represents the application context XML file:</p>

<div class="source">
<div class="source">
<pre>&lt;cache-config
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns=&quot;http://xmlns.oracle.com/coherence/coherence-cache-config&quot;
    xmlns:spring=&quot;class://com.oracle.coherence.spring. SpringNamespaceHandler&quot;
    xsi:schemaLocation=&quot;http://xmlns.oracle.com/coherence/coherence-cache-config coherence-cache-config.xsd
                        class://com.oracle.coherence.spring.SpringNamespaceHandler coherence-spring-config.xsd&quot;&gt;

&lt;spring:bean-factory&gt;
    &lt;spring:application-context-uri&gt;application-context.xml&lt;/spring:application-context-uri&gt;
&lt;/spring:bean-factory&gt;
</pre></div></div>
<p>Additionally, a Spring bean factory can be manually registered as a resource by using the <tt>registerResource</tt> method, as illustrated below. In the example, <tt>DEFAULT_FACTORY_NAME</tt> refers to the default Spring BeanFactory class:</p>

<div class="source">
<div class="source">
<pre>ConfigurableCacheFactory factory = CacheFactory.getCacheFactoryBuilder()
        .getConfigurableCacheFactory(...);

factory.getResourceRegistry().registerResource(
        BeanFactory.class,                            // type
        factoryName,                                  // resource name
        factory,                                      // factory reference
        null);                                        // optional
                                                      // ResourceLifecycleObserver
</pre></div></div>
<p>If you specify a resource name other than the fully-qualified-name of the BeanFactory.class, then reference that name in the bean element. Use the <tt>factory-name</tt> element for the name of the custom bean factory and <tt>bean-name</tt> for the name of the bean.</p>
<p>In the example below, the name of the bean factory is &#x201c;custom-factory&#x201d; and the bean name is &#x201c;listener&#x201d;:</p>

<div class="source">
<div class="source">
<pre>&lt;spring:bean&gt;
    &lt;spring:factory-name&gt;custom-factory&lt;/spring:factory-name&gt;
    &lt;spring:bean-name&gt;listener&lt;/spring:bean-name&gt;
&lt;/spring:bean&gt;
</pre></div></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                   2017.
          All rights reserved.      
                    
      </p>
        </div>

                                                                  
<div class="copyright">Copyright © 2008-2014 Oracle Corporation. All rights reserved.</div>
                                                          
<div class="version">Version 2.0.0-SNAPSHOT: 2017-07-13 20:03</div>
                  
        
                </div>
    </footer>
        </body>
</html>
